<div class="container mt-5">

    <div class="card shadow-sm">
        <div class="card-body">

            <h4 class="mb-3">Create a Tiny URL</h4>

            <form (ngSubmit)="createUrl()" #urlForm="ngForm">

                <!-- URL Input -->
                <div class="mb-3">
                    <label class="form-label">URL</label>
                    <input type="text" class="form-control" placeholder="Enter the long URL" [(ngModel)]="formData.OriginalUrl"
                        name="url" required>
                </div>

                <!-- Radio Buttons -->
                <div class="mb-3">
                    <label class="form-label d-block">Privacy</label>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" id="public" value="false"
                            [(ngModel)]="formData.IsPrivate" name="privacy">
                        <label class="form-check-label" for="public">Public</label>
                    </div>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" id="private" value="true"
                            [(ngModel)]="formData.IsPrivate" name="privacy">
                        <label class="form-check-label" for="private">Private</label>
                    </div>
                </div>

                <!-- Submit Button -->
                <button class="btn btn-primary px-4" type="submit" [disabled]="!urlForm.form.valid">
                    Shorten URL
                </button>

            </form>
        </div>
    </div>

    <!-- Table for URLs -->
    <div class="card shadow-sm mt-4" style="max-height: 350px; overflow-y: auto;">
        <div class="card-body">

            <h4 class="mb-3">Short URLs</h4>

            <!-- Search Input -->
            <div class="mb-3">
                <input type="text" class="form-control" placeholder="Search by original URL or short code..." 
                    [(ngModel)]="searchText" name="search">
            </div>

            <table class="table table-striped table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>#</th>
                        <th>Original URL</th>
                        <th>Short URL</th>
                        <th>Privacy</th>
                        <th>Visit Count</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let item of filteredUrls; let i = index">
                        <td>{{ i + 1 }}</td>
                        <td class="text-break">{{ item.originalUrl }}</td>
                        <td>
                            <a [href]="item.shortUrl" target="_blank">
                                {{ API_BASE + item.shortCode }}
                            </a>
                        </td>
                        <td class="text-capitalize">
                            @if(item.isActive){
                                Private
                            }
                            @else{
                                Public
                            }
                        </td>
                        <td class="text-capitalize">
                            {{ item.visitCount }}
                        </td>
                        <td class="text-center" style="gap: 10px" >
                            <button class="btn btn-outline-secondary btn-sm" style="gap: 10px" (click)="copy(item.shortCode)">
                                Copy
                            </button>
                            <button class="btn btn-danger btn-sm ms-2" (click)="deleteURL(item.shortCode)">
                                Delete
                            </button>
                        </td>
                    </tr>

                </tbody>
            </table>

            <p *ngIf="urls.length === 0" class="text-muted">No URLs created yet.</p>
            <p *ngIf="urls.length > 0 && filteredUrls.length === 0" class="text-muted">No results found for "{{ searchText }}".</p>

        </div>
    </div>

</div>